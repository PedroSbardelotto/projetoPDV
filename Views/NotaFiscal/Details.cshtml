@model PDV.Models.ViewModels.NotaFiscalViewModel

@{
    ViewData["Title"] = "Details";
}

<style>
    :root {
        --primary-color: #0d6efd;
        --bg-light: #f4f6f8;
        --success-soft: #d1e7dd;
        --warning-soft: #fff3cd;
    }

    body {
        background-color: var(--bg-light);
        font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
    }

    /* Topbar */
    .top-bar {
        background: white;
        padding: 0.8rem 1.5rem;
        border-bottom: 1px solid #e0e0e0;
        margin-bottom: 2rem;
        box-shadow: 0 2px 4px rgba(0,0,0,0.02);
    }

    /* Cards */
    .card {
        border: none;
        box-shadow: 0 2px 6px rgba(0,0,0,0.04);
        border-radius: 8px;
        transition: transform 0.2s;
    }

    .card-hover:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0,0,0,0.08);
    }

    /* Status Badges */
    .badge-pending {
        background-color: var(--warning-soft);
        color: #856404;
        border: 1px solid #ffeeba;
    }

    /* Tabela de Preços */
    .table-pricing th {
        font-size: 0.85rem;
        text-transform: uppercase;
        color: #6c757d;
        background-color: #f8f9fa;
        vertical-align: middle;
    }

    .table-pricing td {
        vertical-align: middle;
    }

    .input-currency {
        font-weight: 600;
        color: #198754;
    }

    /* Inputs destacados para edição */
    .editable-cell {
        background-color: #fff;
        border: 1px solid #ced4da;
        border-radius: 4px;
        padding: 2px;
        box-shadow: inset 0 1px 2px rgba(0,0,0,0.075);
    }

        .editable-cell:focus-within {
            border-color: #86b7fe;
            box-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.25);
        }
</style>
<!-- Topo -->
@* <div class="top-bar d-flex justify-content-between align-items-center sticky-top">
    <div class="d-flex align-items-center gap-2">
        <div class="bg-success text-white rounded p-2 lh-1"><i class="bi bi-currency-dollar"></i></div>
        <div>
            <h5 class="m-0 fw-bold text-dark">Faturamento</h5>
            <small class="text-muted">Defina os preços de venda das mercadorias recebidas</small>
        </div>
    </div>
    <div class="d-flex gap-3">
        <div class="text-end d-none d-md-block">
            <small class="text-muted d-block">Pendente de Definição</small>
            <span class="fw-bold text-danger">@Model.ListaFilaFaturamentoDetails.Count Notas</span>
        </div>
    </div>
</div> *@
<div class="container-fluid py-4 back-color">
    <div class="top-bar sticky-top d-flex justify-content-between">
        <div>
            <h4 class="m-0 fw-bold text-primary"><i class="bi bi-currency-dollar me-2"></i>Faturamento</h4>
            <small class="text-muted">Defina os preços de venda das mercadorias recebidas</small>
        </div>
        <div class="d-flex gap-2">
            <div class="text-end d-none d-md-block">
                <small class="text-muted d-block">Pendente de Definição</small>
                <span class="fw-bold text-danger">@Model.ListaFilaFaturamentoDetails.Count Notas</span>
            </div>
        </div>
    </div>
</div>
<div class="container-fluid px-4">
    <div id="view-lista" class="fade show">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h5 class="text-secondary fw-bold m-0">Lista de Faturamentos Pendente</h5>
        </div>

        @if (Model.ListaFilaFaturamentoDetails.Count > 0)
        {
            for (int intIndex = 0; intIndex < Model.ListaFilaFaturamentoDetails.Count; intIndex++)
            {
                <form asp-action="FaturarPendente" asp-controller="NotaFiscal">
                    <input type="hidden" name="Id" asp-for="@Model.ListaFilaFaturamentoDetails[intIndex].Id" />
                    <input type="hidden" name="Id" asp-for="@Model.ListaFilaFaturamentoDetails[intIndex].Numero" />
                    <input type="hidden" name="Id" asp-for="@Model.ListaFilaFaturamentoDetails[intIndex].DataEmissao" />
                    <input type="hidden" name="Id" asp-for="@Model.ListaFilaFaturamentoDetails[intIndex].NomeFornecedor" />
                    <input type="hidden" name="Id" asp-for="@Model.ListaFilaFaturamentoDetails[intIndex].CodigoFornecedor" />

                    @for (int intIndexProd = 0; intIndexProd < Model.ListaFilaFaturamentoDetails[intIndex].ListaFilaFaturamento.Count; intIndexProd++)
                    {
                        <input type="hidden" name="ListaFilaFaturamentoDetails[@intIndex].ListaFilaFaturamento[@intIndexProd].CodigoProdutoNFe" value="@Model.ListaFilaFaturamentoDetails[intIndex].ListaFilaFaturamento[intIndexProd].CodigoProduto" />
                    }

                    <div class="card card-hover mb-3">
                        <div class="card-body">
                            <div class="row align-items-center">
                                <div class="col-md-1 text-center">
                                    <div class="bg-light rounded p-2 text-muted fw-bold border">
                                        <small class="d-block" style="font-size: 0.6rem;">EMISSÃO</small>
                                        @Model.ListaFilaFaturamentoDetails[intIndex].DataEmissao
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <h6 class="fw-bold m-0 text-primary">@Model.ListaFilaFaturamentoDetails[intIndex].NomeFornecedor</h6>
                                    <small class="text-muted">NF-e: <strong>@Model.ListaFilaFaturamentoDetails[intIndex].Numero</strong> &bull; Cód: @Model.ListaFilaFaturamentoDetails[intIndex].CodigoFornecedor</small>
                                </div>
                                <div class="col-md-2">
                                    <small class="text-muted d-block">Total da Nota</small>
                                    <span class="fw-bold text-dark">R$ @Model.ListaFilaFaturamentoDetails[intIndex].ValorTotal</span>
                                </div>
                                <div class="col-md-2">
                                    <small class="text-muted d-block">Itens</small>
                                    <span class="badge bg-info text-dark">@Model.ListaFilaFaturamentoDetails[intIndex].ListaFilaFaturamento.Count Produtos</span>
                                </div>
                                <div class="col-md-2 text-center">
                                    <span class="badge badge-pending rounded-pill px-3 py-2">
                                        <i class="bi bi-hourglass-split me-1"></i> @Model.ListaFilaFaturamentoDetails[intIndex].Status
                                    </span>
                                </div>
                                <div class="col-md-1 text-end">
                                    <button type="submit" class="btn btn-primary btn-sm stretched-link">
                                        Abrir <i class="bi bi-arrow-right"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            }
        }
        else
        {
            <div class="card mb-3">
                <div class="card-body">
                    <div class="row align-items-center" ">
                        <div class="col-md-12 text-center">
                            <p class="fw-bold" style="font-size: 1.2rem">Não há Notas Fiscais para faturar!</p>
                        </div>
                    </div>
                </div>
            </div>
        }

    </div>


@section Scripts
{

}
